from GridResilience.Environment.case_pandas import GridCase
import numpy as np


def case4_loop():
    """
    Define a simple loop network
    which contains 4 buses and 4 branches.

    1 -> 2

    1 -> 3

    2 -> 4

    3 -> 4

    R_ij = 0.9

    :return: GridCase: case4_loop
    """

    branch = np.array([10001, 3001, 3002,
                       10002, 3001, 3003,
                       10003, 3002, 3004,
                       10004, 3003, 3004]).reshape(-1, 3)
    bus = np.array([3001, 0, 5, 110, 1, 0, 1, 0,
                    3002, 2, 3, 333, 1, 21.7, 0, 0,
                    3003, -2, 3, 333, 1, 94.2, 0, 0,
                    3004, 0, 1, 333, 1, 47.8, 0, 0]).reshape(-1, 8)
    linesafe = np.array([0.9] * len(branch)).reshape(-1, 1)
    return GridCase().from_array(branch, bus, linesafe, station_name='case4_loop')


def case_32_modified():
    """
    Define IEEE33 Loop case

    Stats:

    Bus: 32
    Branch: 36
    """
    brh = np.array(
        [10002.00000, 1.00000, 2.00000,
         10003.00000, 2.00000, 3.00000,
         10004.00000, 3.00000, 4.00000,
         10005.00000, 4.00000, 5.00000,
         10006.00000, 5.00000, 6.00000,
         10007.00000, 6.00000, 7.00000,
         10008.00000, 7.00000, 8.00000,
         10009.00000, 8.00000, 9.00000,
         10010.00000, 9.00000, 10.00000,
         10011.00000, 10.00000, 11.00000,
         10012.00000, 11.00000, 12.00000,
         10013.00000, 12.00000, 13.00000,
         10014.00000, 13.00000, 14.00000,
         10015.00000, 14.00000, 15.00000,
         10016.00000, 15.00000, 16.00000,
         10017.00000, 16.00000, 17.00000,
         10018.00000, 1.00000, 18.00000,
         10019.00000, 18.00000, 19.00000,
         10020.00000, 19.00000, 20.00000,
         10021.00000, 20.00000, 21.00000,
         10022.00000, 2.00000, 22.00000,
         10023.00000, 22.00000, 23.00000,
         10024.00000, 23.00000, 24.00000,
         10025.00000, 5.00000, 25.00000,
         10026.00000, 25.00000, 26.00000,
         10027.00000, 26.00000, 27.00000,
         10028.00000, 27.00000, 28.00000,
         10029.00000, 28.00000, 29.00000,
         10030.00000, 29.00000, 30.00000,
         10031.00000, 30.00000, 31.00000,
         10032.00000, 31.00000, 32.00000,
         10033.00000, 20.00000, 7.00000,
         10034.00000, 21.00000, 11.00000,
         10035.00000, 8.00000, 14.00000,
         10036.00000, 32.00000, 17.00000,
         10037.00000, 24.00000, 28.00000]).reshape(-1, 3)
    bus = np.array([1.00000, 2.00000, 0.00000, 110.00000, 1.00000, 1.00000,
                    2.00000, 4.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    3.00000, 6.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    4.00000, 8.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    5.00000, 10.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    6.00000, 12.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    7.00000, 14.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    8.00000, 16.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    9.00000, 18.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    10.00000, 20.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    11.00000, 22.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    12.00000, 24.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    13.00000, 26.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    14.00000, 28.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    15.00000, 30.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    16.00000, 32.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    17.00000, 34.00000, 0.00000, 333.00000, 1.00000, 1.00000,
                    18.00000, 2.00000, 2.00000, 333.00000, 1.00000, 1.00000,
                    19.00000, 4.00000, 2.00000, 333.00000, 1.00000, 1.00000,
                    20.00000, 6.00000, 2.00000, 333.00000, 1.00000, 1.00000,
                    21.00000, 8.00000, 2.00000, 333.00000, 1.00000, 1.00000,
                    22.00000, 4.00000, -4.00000, 333.00000, 1.00000, 1.00000,
                    23.00000, 6.00000, -4.00000, 333.00000, 1.00000, 1.00000,
                    24.00000, 9.00000, -4.00000, 333.00000, 1.00000, 1.00000,
                    25.00000, 10.00000, -2.00000, 333.00000, 1.00000, 1.00000,
                    26.00000, 12.00000, -2.00000, 333.00000, 1.00000, 1.00000,
                    27.00000, 14.00000, -2.00000, 333.00000, 1.00000, 1.00000,
                    28.00000, 16.00000, -2.00000, 333.00000, 1.00000, 1.00000,
                    29.00000, 18.00000, -2.00000, 333.00000, 1.00000, 1.00000,
                    30.00000, 20.00000, -2.00000, 333.00000, 1.00000, 1.00000,
                    31.00000, 22.00000, -2.00000, 333.00000, 1.00000, 1.00000,
                    32.00000, 24.00000, -2.00000, 333.00000, 1.00000, 1.00000]).reshape(-1, 6)
    linesafe = np.array([0.9] * len(brh)).reshape(-1, 1)
    return GridCase().from_array(brh, bus, linesafe, station_name='case_modified_32')


def case4_diamond():
    branch = np.array([10001, 3001, 3002, 311, 0,
                       10002, 3001, 3003, 311, 0,
                       10003, 3002, 3004, 311, 0,
                       10004, 3003, 3004, 311, 0,
                       10005, 3002, 3003, 311, 0]).reshape(-1, 5)
    bus = np.array([3001, 0, 5, 110, 1, 0, 1, 0,
                    3002, 2, 3, 333, 1, 21.7, 0, 0,
                    3003, -2, 3, 333, 1, 94.2, 0, 0,
                    3004, 0, 1, 333, 1, 47.8, 0, 0]).reshape(-1, 8)
    linesafe = np.array([0.9] * len(branch)).reshape(-1, 1)
    return GridCase().from_array(branch, bus, linesafe, station_name='case4_diamond')


def case3_loop():
    branch = np.array([10001, 3001, 3002, 311, 0,
                       10002, 3001, 3003, 311, 0,
                       10003, 3002, 3003, 311, 0]).reshape(-1, 5)
    bus = np.array([3001, 0, 5, 110, 1, 0, 1, 0,
                    3002, 2, 3, 333, 1, 21.7, 0, 0,
                    3003, -2, 3, 333, 1, 94.2, 0, 0]).reshape(-1, 8)
    linesafe = np.array([0.9] * len(branch)).reshape(-1, 1)
    return GridCase().from_array(branch, bus, linesafe, station_name='case3_loop')

def case28_microgrid():
    branch = np.array([
        0, 0, 1, 311, 0,
        1, 1, 2, 311, 0,
        2, 1, 3, 311, 0,
        3, 1, 4, 311, 0,
        4, 2, 5, 311, 0,
        5, 2, 6, 311, 0,
        6, 2, 7, 311, 0,
        7, 2, 8, 311, 0,
        8, 2, 9, 311, 0,
        9, 3, 10, 311, 0,
        10, 3, 11, 311, 0,
        11, 3, 12, 311, 0,
        12, 3, 13, 311, 0,
        13, 3, 14, 311, 0,
        14, 3, 15, 311, 0,
        15, 3, 16, 311, 0,
        16, 3, 17, 311, 0,
        17, 3, 18, 311, 0,
        18, 4, 19, 311, 0,
        19, 4, 20, 311, 0,
        20, 4, 21, 311, 0,
        21, 4, 22, 311, 0,
        22, 4, 23, 311, 0,
        23, 4, 24, 311, 0,
        24, 4, 25, 311, 0,
        25, 4, 26, 311, 0,
        26, 4, 27, 311, 0
    ]).reshape(-1, 5)
    bus = np.array([
        0, 0, 0, 110, 1, 0, 1, 0,
        1, 0, 0, 333, 1, 0, 1, 0,
        2, 0, 0, 333, 1, 0, 1, 0,
        3, 0, 0, 110, 1, 0, 1, 0,
        4, 0, 0, 110, 1, 0, 1, 0,
        5, 0, 0, 110, 1, 0, 1, 0,
        6, 0, 0, 110, 1, 0, 1, 0,
        7, 0, 0, 110, 1, 0, 1, 0,
        8, 0, 0, 110, 1, 0, 1, 0,
        9, 0, 0, 110, 1, 0, 1, 0,
        10, 0, 0, 110, 1, 0, 1, 0,
        11, 0, 0, 110, 1, 0, 1, 0,
        12, 0, 0, 110, 1, 0, 1, 0,
        13, 0, 0, 110, 1, 0, 1, 0,
        14, 0, 0, 110, 1, 0, 1, 0,
        15, 0, 0, 110, 1, 0, 1, 0,
        16, 0, 0, 110, 1, 0, 1, 0,
        17, 0, 0, 110, 1, 0, 1, 0,
        18, 0, 0, 110, 1, 0, 1, 0,
        19, 0, 0, 110, 1, 0, 1, 0,
        20, 0, 0, 110, 1, 0, 1, 0,
        21, 0, 0, 110, 1, 0, 1, 0,
        22, 0, 0, 110, 1, 0, 1, 0,
        23, 0, 0, 110, 1, 0, 1, 0,
        24, 0, 0, 110, 1, 0, 1, 0,
        25, 0, 0, 110, 1, 0, 1, 0,
        26, 0, 0, 110, 1, 0, 1, 0,
        27, 0, 0, 110, 1, 0, 1, 0,
    ]).reshape(-1, 8)
    bus[:, BUS_TYPE] = 333
    bus[[0, 9, 10, 17, 18, 26, 27], BUS_TYPE] = 110
    linesafe = np.array([0.9] * len(branch)).reshape(-1, 1)
    return GridCase().from_array(branch, bus, linesafe)
